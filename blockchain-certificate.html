<link rel="import" href="../polymer/polymer.html">
<link rel="import" href="../iron-ajax/iron-ajax.html">

<!--
`blockchain-certificate`
Displays a rendered Blockchain Certificate

@demo demo/index.html
-->

<dom-module id="blockchain-certificate">
  <template>
    <style>
      :host {
        display: block;
        border: 1px solid #111111;
        background-color: red;
      }
    </style>
    <iron-ajax
      auto
      url=[[href]]
      handle-as="json"
      on-response="handleResponse"
      on-error="handleError"
      debounce-duration="300">
    </iron-ajax>


    <img src="https://media.giphy.com/media/7ju6mxgTagFna/giphy.gif" />
    <span class="recipient">R: [[recipient]]</span>
    <span class="title">T: [[title]]</span>
    <span class="subtitle">S: [[subtitle]]</span>

    <div class="error">[[error]]</div>
  </template>

  <script>
    Polymer({

      is: 'blockchain-certificate',

      properties: {
        href: {
          type: String,
          value: 'blockchain-certificate',
          // observer: '_hrefChanged'
        },

        /* read-only properties */
        recipient: {
          type: String,
          readOnly: true
        },
        title: {
          type: String,
          readOnly: true
        },
        subtitle: {
          type: String,
          readOnly: true
        },

        error: {
          type: String,
          readOnly: true
        }
      },
      // ready: function(newValue, b, c, d) {
      // // _hrefChanged: function(newValue, oldValue) {
      //   // TODO: Get data from XMLHTTPRequest
      //   this.$.xhr.send({
      //     url: this.href,
      //   }).then(function(result, b, c, d) {
      //     console.log(result, b, c, d)
      //     this._setRecipient('Chris Downie');
      //     this._setTitle('The best');
      //     this._setSubtitle('At Everything');
      //   })
      // },
      handleResponse: function(response) {
        console.log('handleResponse', response)
      },
      handleError: function(error) {
        console.log('handleError', error);
        this._setError('Failed to fetch certificate at URL.');
      }
    });
  </script>
</dom-module>
